\documentclass[11pt]{article}

\usepackage[utf8]{inputenc}
\usepackage[spanish]{babel}
\usepackage{amsmath}
\usepackage{a4wide}
\usepackage{graphicx}
\usepackage{minted}

\title{Métodos Numéricos II - Cuerda vibrante}
\author{Unai Aguilera Irazabal\\ DNI: 45663055M}

\begin{document}
\maketitle
\tableofcontents

\section{Introducción}
La ecuación que define el movimiento de la cuerda vibrante amortiguada es la siguiente

\begin{equation}
\frac{\partial^2 y}{\partial{t^2}} = \frac{Tg}{\rho}\frac{\partial^2 y}{\partial{x^2}} 
	- B\frac{\partial y}{\partial{t}}
\label{eq:cuerda}
\end{equation}

donde $B$ es la magnitud de la fuerza de amortiguamiento, mientras que T es la tensión de
la cuerda, $g$ la aceleración de la gravedad y $\rho$ su densidad lineal. 
La ecuación de la cuerda vibrante es una ecuación de tipo hiperbólico que para su resolución
es necesario conocer los valores de frontera (posición y/o velocidad de los extremos) y
dos condiciones iniciales, los valores de $y$ y la velocidad de cada punto en el instante
inicial $t=0$.

En el caso del problema propuesto, las condiciones iniciales son

\begin{subequations}
\begin{flalign}
	&y(x)|_{t=0} = \frac{x}{3},~~~~~~~~~~~~~~~~~~ 0 <= x < \frac{3}{5}\\
	&y(x)|_{t=0} = \frac{1}{2}(1 - x),~~~~~~~~~ \frac{3}{5} <= x <= 1\\
	&\frac{\partial{y}}{\partial{t}}|_{t=0} = x(x-1)
\end{flalign}
\label{eq:condiciones_iniciales}
\end{subequations}

\section{Método de resolución}
La ecuación puede ser resuelta de forma numérica mediante la substitución de las derivadas
por aproximaciones con diferencias finitas. Así, cada una de las derivadas que aparecen
pueden substituirse por las siguientes aproximaciones

\begin{subequations}
\begin{flalign}
	&\frac{\partial^2 y}{\partial{x^2}} = \frac{y^j_{i+1} - 2y^j_i + y^j_{i-1}}{(\Delta{x})^2}\\
	&\frac{\partial^2 y}{\partial{t^2}} = \frac{y^{j+1}_i - 2y^j_i + y^{j-1}_i}{(\Delta{t})^2}\\
	&\frac{\partial{y}}{\partial{t}} = \frac{y^{j+1}_i - y^{j-1}_i}{2\Delta{t}}
\end{flalign}
\end{subequations}

Substituyendo las aproximaciones en la ecuación \ref{eq:cuerda}, se obtiene la siguiente
expresión

\begin{equation}
\frac{y^{j+1}_i - 2y^j_i + y^{j-1}_i}{(\Delta{t})^2} = 
	\frac{Tg}{\rho}\frac{y^j_{i+1} - 2y^j_i + y^j_{i-1}}{(\Delta{x})^2}
	- B \frac{y^{j+1}_i - y^{j-1}_i}{2\Delta{t}}
\end{equation}

de donde reordenando términos 

\begin{equation}
y^{j+1}_{i} - 2y^{j}_i + y^{j-1}_i = \frac{Tg(\Delta{t})^2}{\rho(\Delta{x})^2}
	(y^j_{i+1} - 2y^j_i + y^j_{i-1}) - \frac{B\Delta{t}}{2}(y^{j+1}_i - y^{j-1}_i)
\label{eq:aproximacion}
\end{equation}

Si en la expresión anterior el valor $\frac{Tg(\Delta{t})^2}{\rho(\Delta{x})^2}$ se iguala
a la unidad y se despeja el desplazamiento $y^{j+1}_i$, que resulta al final del paso de
tiempo actual, se obtiene la siguiente expresión

\begin{equation}
y^{j+1}_i = \frac{y^j_{i+1} + y^j_{i-1} + (\frac{B\Delta{t}}{2} - 1)y^{j-1}_i}{(\frac{B\Delta{t}}{2} + 1)}
\label{eq:pasos_siguientes}
\end{equation}

que permite calcular el valor de un nodo i a partir de la información de los nodos vecinos
a derecha e izquierda y del valor del propio nodo en un instante anterior. El valor de 
$\Delta{t}$ puede obtenerse a partir de la simplificación realizada anteriormente 

\begin{equation}
\Delta{t} = \frac{\Delta{x}}{\sqrt{\frac{Tg}{\rho}}}
\label{eq:paso_tiempo}
\end{equation}

y que permite obtener el tamaño del paso de tiempo a partir de las características físicas
de la cuerda vibrante y del paso espacial definido para la subdivisión en intervalos de
diferencias finitas durante la aproximación de las derivadas.

La expresión anterior permite obtener la evolución del sistema en todo paso de tiempo
salvo en el primero ($0 \rightarrow 1$). Sin embargo, este puede determinarse a partir del 
conocimiento de la velocidad inicial del sistema proporcionada por 
$\frac{\partial{y}}{\partial{x}}|_{t=0}$ como condiciones iniciales. Así, en el paso
inicial

\begin{equation}
\frac{y^1_i - y^{-1}_i}{2\Delta{t}} = \frac{\partial{y}}{\partial{x}}|_{t=0}
\label{eq:aprox_derivada}
\end{equation}

A partir de la ecuación \ref{eq:aproximacion} y substituyendo nuevamente el valor de 
$\frac{Tg(\Delta{t})^2}{\rho(\Delta{x})^2}$ por la unidad se obtiene

\begin{equation}
y^{j+1}_i = y^{j}_{i+1} + y^{j}_{j-1} - y^{j-1}_i - \frac{B\Delta{t}}{2}(y^{j+1}_i - y^{j-1}_i)
\end{equation}

utilizando esta ecuación para el paso inicial y substituyendo en ella la aproximación dada
por la ecuación \ref{eq:aprox_derivada}, y tras despejar nuevamente $y^{j+1}_i$ se obtiene
la siguiente expresión para el paso inicial del método numérico

\begin{equation}
y^1_i = \frac{y^0_{i+1} + y^0_{i-1}}{2} + \Delta{t}\frac{\partial{y}}{\partial{x}}|_{t=0}
	- \frac{B\Delta{t}^2}{2}\frac{\partial{y}}{\partial{x}}|_{t=0}
\label{eq:paso_inicial}
\end{equation}

\section{Caso no amortiguado}
Para el caso de la cuerda vibrante sin amortiguamiento, las ecuaciones para su
solución mediante el método numérico por aproximación de diferencias finitas se obtienen
haciendo $B=0$ en las ecuaciones \ref{eq:pasos_siguientes} y \ref{eq:paso_inicial}. Además,
se ha llevado a cabo la substitución de $\frac{\partial{y}}{\partial{x}}|_{t=0}$ por la
expresión indicada por las condiciones iniciales del problema.

\begin{subequations}
\begin{flalign}
	&y^1_i = \frac{y^0_{i+1} + y^0_{i-1}}{2} + x(x-1)\Delta{t}\\
	&y^{j+1}_i = y^j_{i+1} + y^j_{i-1} - y^{j-1}_i
\end{flalign}
\end{subequations}

Utilizando las expresiones anteriores de forma iterativa e inicializando los valores de
los nodos de la cuerda para $t=0$ segun las condiciones indicadas en el problema
(eq. \ref{eq:condiciones_iniciales}) se obtienen los resultados recogidos en la Tabla 
\ref{tab:est_freq} para la posición de la cuerda en pasos consecutivos de tiempo. 

\begin{table}
\center
\begin{small}
\begin{tabular}{ c c c c c c c c c c c c }
\hline
Paso & 0.00 & 0.10 & 0.20 & 0.30 & 0.40 & 0.50 & 0.60 & 0.70 & 0.80 & 0.90 & 1.00 \\
\hline
\hline
0 & 0.00 & 0.03 & 0.07 & 0.10 & 0.13 & 0.17 & 0.20 & 0.15 & 0.10 & 0.05 & 0.00 \\
1 & 0.00 & 0.03 & 0.07 & 0.10 & 0.13 & 0.16 & 0.16 & 0.15 & 0.10 & 0.05 & 0.00 \\
2 & 0.00 & 0.03 & 0.06 & 0.10 & 0.13 & 0.12 & 0.11 & 0.11 & 0.10 & 0.05 & 0.00 \\
3 & 0.00 & 0.03 & 0.06 & 0.10 & 0.09 & 0.08 & 0.07 & 0.06 & 0.06 & 0.05 & 0.00 \\
4 & 0.00 & 0.03 & 0.06 & 0.05 & 0.04 & 0.04 & 0.03 & 0.02 & 0.01 & 0.01 & 0.00 \\
5 & 0.00 & 0.03 & 0.02 & 0.01 & 0.00 & -0.01 & -0.01 & -0.02 & -0.03 & -0.04 & 0.00 \\
6 & 0.00 & -0.01 & -0.02 & -0.03 & -0.04 & -0.05 & -0.06 & -0.06 & -0.07 & -0.04 & 0.00 \\
7 & 0.00 & -0.05 & -0.06 & -0.07 & -0.08 & -0.09 & -0.10 & -0.10 & -0.07 & -0.03 & 0.00 \\
8 & 0.00 & -0.05 & -0.10 & -0.11 & -0.12 & -0.13 & -0.14 & -0.10 & -0.07 & -0.03 & 0.00 \\
9 & 0.00 & -0.05 & -0.10 & -0.15 & -0.16 & -0.17 & -0.14 & -0.10 & -0.07 & -0.03 & 0.00 \\
10 & 0.00 & -0.05 & -0.10 & -0.15 & -0.20 & -0.17 & -0.13 & -0.10 & -0.07 & -0.03 & 0.00 \\
11 & 0.00 & -0.05 & -0.10 & -0.15 & -0.16 & -0.16 & -0.13 & -0.10 & -0.07 & -0.03 & 0.00 \\
12 & 0.00 & -0.05 & -0.10 & -0.11 & -0.11 & -0.12 & -0.13 & -0.10 & -0.06 & -0.03 & 0.00 \\
13 & 0.00 & -0.05 & -0.06 & -0.06 & -0.07 & -0.08 & -0.09 & -0.10 & -0.06 & -0.03 & 0.00 \\
14 & 0.00 & -0.01 & -0.01 & -0.02 & -0.03 & -0.04 & -0.04 & -0.05 & -0.06 & -0.03 & 0.00 \\
15 & 0.00 & 0.04 & 0.03 & 0.02 & 0.01 & 0.01 & -0.00 & -0.01 & -0.02 & -0.03 & 0.00 \\
16 & 0.00 & 0.04 & 0.07 & 0.06 & 0.06 & 0.05 & 0.04 & 0.03 & 0.02 & 0.01 & 0.00 \\
17 & 0.00 & 0.03 & 0.07 & 0.10 & 0.10 & 0.09 & 0.08 & 0.07 & 0.06 & 0.05 & 0.00 \\
18 & 0.00 & 0.03 & 0.07 & 0.10 & 0.14 & 0.13 & 0.12 & 0.11 & 0.10 & 0.05 & 0.00 \\
19 & 0.00 & 0.03 & 0.07 & 0.10 & 0.14 & 0.17 & 0.16 & 0.15 & 0.10 & 0.05 & 0.00 \\
\hline
20 & 0.00 & 0.03 & 0.07 & 0.10 & 0.13 & 0.17 & 0.20 & 0.15 & 0.10 & 0.05 & 0.00 \\
\hline
21 & 0.00 & 0.03 & 0.07 & 0.10 & 0.13 & 0.16 & 0.16 & 0.15 & 0.10 & 0.05 & 0.00 \\
22 & 0.00 & 0.03 & 0.06 & 0.10 & 0.13 & 0.12 & 0.11 & 0.11 & 0.10 & 0.05 & 0.00 \\
23 & 0.00 & 0.03 & 0.06 & 0.10 & 0.09 & 0.08 & 0.07 & 0.06 & 0.06 & 0.05 & 0.00 \\
24 & 0.00 & 0.03 & 0.06 & 0.05 & 0.04 & 0.04 & 0.03 & 0.02 & 0.01 & 0.01 & 0.00 \\
25 & 0.00 & 0.03 & 0.02 & 0.01 & 0.00 & -0.01 & -0.01 & -0.02 & -0.03 & -0.04 & 0.00 \\
\end{tabular}
\end{small}
\caption{Resultados de la cuerda en vibración para $\Delta{x} = 0.1$ cm}
\label{tab:est_freq}
\end{table}

En la tabla se observa que la cuerda vuelve a su estado inicial cuando han transcurrido
20 pasos de tiempo. Por lo tanto, teniendo en cuenta la ecuación \ref{eq:paso_tiempo} de
donde es posible obtener el valor de un paso de tiempo $\Delta{t} = 0.0071$ s mediante la
substitución de los parámetros de la cuerda y el intervalo espacial elegido. A partir del
tamaño de un paso de tiempo se obtiene que

\begin{equation}
f = \frac{1}{n \Delta{t}} = \frac{1}{20 * 0.0071} = 7.04~Hz
\end{equation}

En la tabla \ref{tab:est_velocidad} se recogen nuevamente los resultados para algunos nodos
para el mismo intervalo espacial $\Delta{x} = 0.1$ cm. Sin embargo, en este caso se han
calculado también las velocidades de los puntos de la cuerda. Las velocidades han sido
calculadas utilizando las diferencias de posición entre dos instantes consecutivos de
tiempo de acuerdo al siguiente esquema

\begin{equation}
\frac{\partial{y}}{\partial{t}} = \frac{y^{j + 1}_i - y^{j}_i}{\Delta{t}}
\end{equation} 

\begin{table}
\center
\begin{small}
\begin{tabular}{ c c c c c }
\hline
Paso & 0.30 & 0.40 & 0.50 & 0.60 \\
\hline
\hline
0 & 0.10 (-0.21) & 0.13 (-0.24) & 0.17 (-0.25) & 0.20 (-6.07) \\
1 & 0.10 (-0.19) & 0.13 (-0.22) & 0.16 (-6.06) & 0.16 (-6.05) \\
2 & 0.10 (-0.15) & 0.13 (-6.01) & 0.12 (-6.02) & 0.11 (-6.01) \\
3 & 0.10 (-5.92) & 0.09 (-5.95) & 0.08 (-5.96) & 0.07 (-5.95) \\
4 & 0.05 (-5.86) & 0.04 (-5.87) & 0.04 (-5.88) & 0.03 (-5.87) \\
5 & 0.01 (-5.80) & 0.00 (-5.79) & -0.01 (-5.78) & -0.01 (-5.79) \\
6 & -0.03 (-5.74) & -0.04 (-5.71) & -0.05 (-5.70) & -0.06 (-5.71) \\
7 & -0.07 (-5.68) & -0.08 (-5.65) & -0.09 (-5.64) & -0.10 (-5.65) \\
8 & -0.11 (-5.64) & -0.12 (-5.61) & -0.13 (-5.60) & -0.14 (0.22) \\
9 & -0.15 (0.21) & -0.16 (-5.59) & -0.17 (0.25) & -0.14 (0.24) \\
10 & -0.15 (0.21) & -0.20 (6.07) & -0.17 (0.25) & -0.13 (0.24) \\
11 & -0.15 (6.02) & -0.16 (6.05) & -0.16 (6.06) & -0.13 (0.22) \\
12 & -0.11 (5.98) & -0.11 (6.01) & -0.12 (6.02) & -0.13 (6.01) \\
13 & -0.06 (5.92) & -0.07 (5.95) & -0.08 (5.96) & -0.09 (5.95) \\
14 & -0.02 (5.86) & -0.03 (5.87) & -0.04 (5.88) & -0.04 (5.87) \\
15 & 0.02 (5.80) & 0.01 (5.79) & 0.01 (5.78) & -0.00 (5.79) \\
16 & 0.06 (5.74) & 0.06 (5.71) & 0.05 (5.70) & 0.04 (5.71) \\
17 & 0.10 (-0.15) & 0.10 (5.65) & 0.09 (5.64) & 0.08 (5.65) \\
18 & 0.10 (-0.19) & 0.14 (-0.22) & 0.13 (5.60) & 0.12 (5.61) \\
19 & 0.10 (-0.21) & 0.14 (-0.24) & 0.17 (-0.25) & 0.16 (5.59) \\
20 & 0.10 (-0.21) & 0.13 (-0.24) & 0.17 (-0.25) & 0.20 (-6.07) \\
21 & 0.10 (-0.19) & 0.13 (-0.22) & 0.16 (-6.06) & 0.16 (-6.05) \\
22 & 0.10 (-0.15) & 0.13 (-6.01) & 0.12 (-6.02) & 0.11 (-6.01) \\
23 & 0.10 (-5.92) & 0.09 (-5.95) & 0.08 (-5.96) & 0.07 (-5.95) \\
24 & 0.05 (-5.86) & 0.04 (-5.87) & 0.04 (-5.88) & 0.03 (-5.87) \\
\end{tabular}
\end{small}
\caption{Posición y velocidad de algunos nodos de la cuerda para $\Delta{x} = 0.1$ cm }
\label{tab:est_velocidad}
\end{table}

\subsection{Solución analítica}
\label{sec:sol_analitica}
La solución analítica en el caso de la cuerda vibrante puede obtenerse mediante el método
de separación de variables. Si en la ecuación \ref{eq:cuerda} se realiza la siguiente
substitución

\begin{equation}
y(x,t) = u(x)v(t)
\end{equation}

es posible obtener el siguiente sistema de ecuaciones haciendo que cada parte de la ecuación
dependa únicamente de una variable e igualando cada lado a $-K$.

\begin{subequations}
\begin{flalign}
	&v''(t) = K\\
\end{flalign}
\end{subequations}

\subsection{Precisión del método}

Las tablas \ref{tab:comparativa1}, \ref{tab:comparativa2} y \ref{tab:comparativa3} los
resultados de posición para diferentes intervalos $\Delta{x}$ y entre paréntesis se muestra
el error $\epsilon = |y_i - y_{analitico}|$ para cada valor calculado utilizando el valor
proporcionado para el $(x,t)$ correspondiente por la solución analítica de la sección 
\ref{sec:sol_analitica}.

Como puede observarse, aun con una división en intervalos de $Delta{x} = 0.2 cm$, se 
obtiene una buena precisión comparada con la solución analítica, ya que existe únicamente
una diferencia a partir de la 4 cifra decimal. Es diferencia se reduce, como puede
observarse en las siguientes tablas, al incrementar el número de intervalos en los que se
divide la cuerda, lo que reduce no solamente el valor de $\Delta{x}$ sino también el de
$\Delta{t}$ que se encuentra relacionado directamente con este, por lo que es necesario
llevar a cabo un mayor número de calculos para llegar a los mismos instantes de tiempo.

\begin{table}
\center
\begin{tabular}{ c c c c c }
\hline
Paso & 0.20 & 0.40 & 0.60 & 0.80 \\
\hline
\hline
0 & 0.0667 (0.0000) & 0.1333 (0.0000) & 0.2000 (0.0008) & 0.1000 (0.0000) \\
1 & 0.0644 (0.0002) & 0.1299 (0.0002) & 0.1132 (0.0002) & 0.0977 (0.0002) \\
2 & 0.0632 (0.0002) & 0.0443 (0.0004) & 0.0276 (0.0004) & 0.0132 (0.0002) \\
3 & -0.0201 (0.0002) & -0.0390 (0.0004) & -0.0557 (0.0004) & -0.0701 (0.0006) \\
4 & -0.1023 (0.0006) & -0.1201 (0.0002) & -0.1368 (0.0006) & -0.0690 (0.0002) \\
5 & -0.1000 (0.0000) & -0.2000 (0.0008) & -0.1333 (0.0000) & -0.0667 (0.0000) \\
6 & -0.0977 (0.0002) & -0.1132 (0.0002) & -0.1299 (0.0002) & -0.0644 (0.0002) \\
7 & -0.0132 (0.0002) & -0.0276 (0.0004) & -0.0443 (0.0004) & -0.0632 (0.0002) \\
8 & 0.0701 (0.0006) & 0.0557 (0.0004) & 0.0390 (0.0004) & 0.0201 (0.0002) \\
9 & 0.0690 (0.0002) & 0.1368 (0.0006) & 0.1201 (0.0002) & 0.1023 (0.0006) \\
10 & 0.0667 (0.0000) & 0.1333 (0.0000) & 0.2000 (0.0008) & 0.1000 (0.0000) \\
\end{tabular}
\caption{Precisión del método comparado con la solución analítica para $\Delta{x} = 0.2$ cm}
\label{tab:comparativa1}
\end{table}

\begin{table}
\center
\begin{tabular}{ c c c c c }
\hline
Paso & 0.10 & 0.20 & 0.30 & 0.40 \\
\hline
\hline
0 & 0.0333 (0.0000) & 0.0667 (0.0000) & 0.1000 (0.0000) & 0.1333 (0.0000) \\
1 & 0.0327 (0.0000) & 0.0655 (0.0000) & 0.0985 (0.0000) & 0.1316 (0.0000) \\
2 & 0.0322 (0.0000) & 0.0645 (0.0000) & 0.0971 (0.0000) & 0.1300 (0.0004) \\
3 & 0.0318 (0.0000) & 0.0638 (0.0000) & 0.0961 (0.0004) & 0.0871 (0.0001) \\
4 & 0.0316 (0.0000) & 0.0634 (0.0004) & 0.0538 (0.0001) & 0.0446 (0.0001) \\
5 & 0.0315 (0.0004) & 0.0216 (0.0000) & 0.0119 (0.0001) & 0.0026 (0.0001) \\
6 & -0.0100 (0.0000) & -0.0200 (0.0000) & -0.0296 (0.0001) & -0.0388 (0.0001) \\
7 & -0.0515 (0.0004) & -0.0612 (0.0000) & -0.0706 (0.0001) & -0.0796 (0.0001) \\
8 & -0.0511 (0.0000) & -0.1021 (0.0005) & -0.1112 (0.0000) & -0.1200 (0.0000) \\
9 & -0.0506 (0.0000) & -0.1011 (0.0000) & -0.1515 (0.0004) & -0.1600 (0.0000) \\
10 & -0.0500 (0.0000) & -0.1000 (0.0000) & -0.1500 (0.0000) & -0.2000 (0.0008) \\
\end{tabular}
\caption{Precisión del método comparado con la solución analítica para $\Delta{x} = 0.1$ cm}
\label{tab:comparativa2}
\end{table}

\begin{table}
\center
\begin{tabular}{ c c c c c }
\hline
Paso & 0.05 & 0.10 & 0.15 & 0.20 \\
\hline
\hline
0 & 0.0167 (0.0000) & 0.0333 (0.0000) & 0.0500 (0.0000) & 0.0667 (0.0000) \\
1 & 0.0165 (0.0000) & 0.0330 (0.0000) & 0.0495 (0.0000) & 0.0661 (0.0000) \\
2 & 0.0163 (0.0000) & 0.0327 (0.0000) & 0.0491 (0.0000) & 0.0655 (0.0000) \\
3 & 0.0162 (0.0000) & 0.0324 (0.0000) & 0.0487 (0.0000) & 0.0650 (0.0000) \\
4 & 0.0161 (0.0000) & 0.0322 (0.0000) & 0.0484 (0.0000) & 0.0646 (0.0000) \\
5 & 0.0160 (0.0000) & 0.0320 (0.0000) & 0.0481 (0.0000) & 0.0642 (0.0000) \\
6 & 0.0159 (0.0000) & 0.0319 (0.0000) & 0.0478 (0.0000) & 0.0638 (0.0000) \\
7 & 0.0159 (0.0000) & 0.0317 (0.0000) & 0.0476 (0.0000) & 0.0636 (0.0000) \\
8 & 0.0158 (0.0000) & 0.0316 (0.0000) & 0.0475 (0.0000) & 0.0634 (0.0004) \\
9 & 0.0158 (0.0000) & 0.0316 (0.0000) & 0.0474 (0.0004) & 0.0425 (0.0000) \\
10 & 0.0158 (0.0000) & 0.0316 (0.0004) & 0.0266 (0.0000) & 0.0216 (0.0000) \\
\end{tabular}

\caption{Precisión del método comparado con la solución analítica para $\Delta{x} = 0.05$ cm}
\label{tab:comparativa3}
\end{table}

\section{Conclusiones}

\end{document}